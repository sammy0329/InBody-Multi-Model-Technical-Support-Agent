<!--
========================================
Sync Impact Report
========================================
- 버전 변경: 1.0.0 → 1.1.0
- 변경된 원칙:
  - 기존 유지: I. 언어 규칙 (Language Rule)
  - 기존 유지: II. 엄격한 기종 격리 (Strict Model Isolation)
  - 기존 유지: III. 안전 및 면책 (Safety & Disclaimer)
  - 기존 유지: IV. 사용자 맞춤형 톤앤매너 (Adaptive Tone)
  - 추가: V. UI 및 배포 원칙 (Streamlit & Deployment)
  - 추가: VI. 자동화된 오류 수정 및 진척도 관리 (Error Handling & Tracking)
  - 추가: VII. 사용자 의사결정 존중 (Interactive Decision)
- 추가된 섹션: 없음
- 제거된 섹션: 없음
- 템플릿 업데이트 현황:
  - .specify/templates/plan-template.md ✅ 일관성 확인 완료 (Constitution Check 섹션 존재)
  - .specify/templates/spec-template.md ✅ 일관성 확인 완료
  - .specify/templates/tasks-template.md ✅ 일관성 확인 완료
  - .specify/templates/checklist-template.md ✅ 일관성 확인 완료
- 후속 TODO: plan.md 헌법 검증 테이블에 V~VII 원칙 추가 필요
========================================
-->

# InBody Multi-Model Technical Support Agent Constitution

## Core Principles

### I. 언어 규칙 (Language Rule)

모든 프로젝트 산출물은 반드시 **한국어(Korean)**로 작성해야 한다.

- 명세서(spec), 기술 계획(plan), 태스크 목록(tasks)은 반드시 한국어로 작성한다.
- 소스 코드 주석은 반드시 한국어로 작성한다.
- Git 커밋 메시지는 반드시 한국어로 작성한다.
- 변수명, 함수명, 클래스명 등 코드 식별자(identifier)는 영문 사용을 허용한다.
- 외부 라이브러리 및 프레임워크의 고유 용어는 원문 그대로 사용할 수 있다.

**근거**: 프로젝트 팀의 주 언어가 한국어이며, 일관된 언어 사용을 통해 커뮤니케이션 오류를 방지한다.

### II. 엄격한 기종 격리 (Strict Model Isolation)

InBody 기종(270S, 580, 770S, 970S) 간의 정보는 절대 혼합되어서는 안 된다.

- 각 기종의 기술 문서, 에러 코드, 측정 항목, 하드웨어 사양은 반드시 기종별로 분리 관리한다.
- RAG(검색 증강 생성) 검색 시 반드시 식별된 기종의 메타데이터 필터를 적용해야 한다.
- 사용자 질의에서 기종이 식별되지 않은 경우, 반드시 기종을 먼저 확인한 후 응답한다.
- 기종 간 공통 정보(예: 일반적인 체성분 분석 개념)는 명시적으로 "공통" 카테고리로 분류하여 관리한다.
- 한 기종의 정보가 다른 기종의 응답에 포함되는 것은 심각한 결함(Critical Defect)으로 간주한다.

**근거**: 기종마다 측정 항목, 알고리즘, 하드웨어 사양이 상이하므로, 잘못된 정보 제공은 사용자 신뢰를 훼손하고 안전 문제를 야기할 수 있다.

### III. 안전 및 면책 (Safety & Disclaimer)

사용자 안전과 법적 보호를 위해 다음 규칙을 반드시 준수한다.

- 모든 임상적/의학적 해석이 포함된 응답에는 반드시 다음 면책 문구를 포함한다:
  > "이 정보는 의학적 진단이 아니며, 전문 의료인의 상담을 대체하지 않습니다."
- 하드웨어 수리 안내 시 지원 수준을 엄격히 구분한다:
  - **Level 1 (사용자 해결)**: 전원 재시작, 케이블 확인, 캘리브레이션, 소프트웨어 업데이트 등 사용자가 안전하게 수행 가능한 조치
  - **Level 3 (서비스 센터 이관)**: 내부 부품 교체, 센서 수리, 메인보드 관련 문제 등 전문 기술자 개입이 필요한 조치
- Level 1과 Level 3 사이의 경계가 모호한 경우, 반드시 Level 3(서비스 센터 이관)으로 안내한다.
- 사용자가 Level 3 조치를 직접 수행하겠다고 요청하는 경우, 안전 경고와 함께 서비스 센터 연락처를 제공한다.

**근거**: 부정확한 의학적 해석이나 부적절한 하드웨어 수리 시도는 사용자 건강 및 장비 안전에 직접적인 위험을 초래한다.

### IV. 사용자 맞춤형 톤앤매너 (Adaptive Tone)

기종에 따라 사용자 유형을 구분하고, 각 유형에 맞는 커뮤니케이션 방식을 적용한다.

- **보급형 (270S / 580)**:
  - 쉽고 실용적인 말투를 사용한다.
  - 전문 용어 사용을 최소화하고, 사용 시 반드시 쉬운 설명을 병행한다.
  - 단계별 안내(step-by-step)를 기본으로 한다.
  - 예시와 비유를 적극 활용한다.
- **전문가용 (770S / 970S)**:
  - 전문적이고 근거 중심의 말투를 사용한다.
  - 기술 용어를 적극 사용하되, 정확한 정의와 함께 제시한다.
  - 측정 원리, 알고리즘 근거, 논문 참조 등 심층적 정보를 제공한다.
  - 데이터 해석 시 통계적 맥락과 임상적 의미를 함께 설명한다.

**근거**: 보급형 사용자(피트니스 센터, 개인)와 전문가용 사용자(병원, 연구기관)의 지식 수준과 정보 요구가 근본적으로 다르다.

### V. UI 및 배포 원칙 (Streamlit & Deployment)

프론트엔드 UI와 배포 전략에 대한 기술적 원칙을 정의한다.

- **UI 프레임워크**: Python 기반의 **Streamlit**을 사용하여 채팅 인터페이스를 구현한다. 복잡한 CSS보다는 Streamlit의 네이티브 기능(`st.chat_message`, `st.sidebar`) 활용을 우선한다.
- **배포 전략**: **AWS EC2 Spot 인스턴스**에 **Docker Compose**로 배포한다. 비용 절감을 위해 자동 시작/중지 스케줄링(EventBridge)을 고려한 구조로 설계한다.
- UI 코드는 `ui/` 디렉토리에서 백엔드(`src/`)와 물리적으로 분리하여 관리한다.
- UI에서 백엔드 접근 시 반드시 HTTP API를 통해야 하며, 직접 모듈 import를 금지한다.

**근거**: Python 단일 언어로 프론트엔드까지 구현하여 개발 복잡도를 최소화하고, 데모용 배포 비용을 월 $5 이내로 제한한다.

### VI. 자동화된 오류 수정 및 진척도 관리 (Error Handling & Tracking)

개발 중 발생하는 오류와 진행 상황 관리에 대한 원칙을 정의한다.

- **UI 에러 검증**: Streamlit 실행 시 발생하는 런타임 에러(Runtime Error)나 UI 깨짐 현상을 확인하고, 발견 시 즉시 코드를 수정하여 해결한다.
- **체크박스 관리**: 작업이 완료되면 `specs/001-inbody-tech-master/tasks.md`의 체크박스를 반드시 `[x]`로 업데이트하여 진행 상황을 가시화한다.
- 태스크 완료 판정 기준: 해당 태스크에서 요구하는 파일이 생성/수정되고, 명시된 기능이 정상 동작하는 상태여야 한다.
- 에러 발생 시 근본 원인을 파악하고 수정한 후, 동일 유형의 에러가 재발하지 않도록 한다.

**근거**: 진척도의 실시간 가시화는 프로젝트 관리 효율을 높이고, 누락된 작업을 방지한다.

### VII. 사용자 의사결정 존중 (Interactive Decision)

주요 설계 결정에서 사용자 의사를 존중하는 원칙을 정의한다.

- 주요 설계 결정(예: AWS 리전 선택, Spot 인스턴스 타입 결정, UI 레이아웃 옵션 등)이 필요한 경우, 임의로 진행하지 않고 사용자에게 옵션을 제시하여 승인을 받는다.
- 옵션 제시 시 각 선택지의 장단점, 비용 영향, 기술적 트레이드오프를 함께 설명한다.
- 사용자가 명시적으로 위임한 결정 사항은 최적의 판단으로 진행할 수 있다.

**근거**: 프로젝트 소유자의 의사결정 권한을 보장하고, 예상치 못한 방향 전환으로 인한 작업 낭비를 방지한다.

## 지원 대상 기종 및 분류

본 프로젝트가 지원하는 InBody 기종과 그 분류는 다음과 같다.

| 기종 | 분류 | 주요 대상 | 톤앤매너 |
|------|------|-----------|----------|
| InBody 270S | 보급형 | 피트니스 센터, 소규모 클리닉 | 쉽고 실용적 |
| InBody 580 | 보급형 | 기업 건강관리, 체육시설 | 쉽고 실용적 |
| InBody 770S | 전문가용 | 병원, 대학 연구실 | 전문적 근거 중심 |
| InBody 970S | 전문가용 | 종합병원, 대규모 연구기관 | 전문적 근거 중심 |

- 위 4개 기종 이외의 기종에 대한 질문은 "현재 지원하지 않는 기종"임을 안내하고, InBody 공식 고객센터를 안내한다.
- 향후 지원 기종 추가 시, 본 헌법의 개정 절차를 따른다.

## 개발 워크플로우

본 프로젝트의 개발은 다음 워크플로우를 따른다.

- 모든 기능 개발은 명세서(spec) 작성을 선행한다.
- 명세서 작성 시 본 헌법의 7대 원칙 준수 여부를 반드시 검증한다.
- 기종별 데이터 및 로직은 물리적으로 분리된 모듈 또는 네임스페이스에서 관리한다.
- 코드 리뷰 시 기종 격리 원칙(Principle II) 위반 여부를 필수 체크 항목으로 포함한다.
- 면책 문구(Principle III) 삽입 여부는 자동화된 검증을 통해 확인하는 것을 권장한다.

## Governance

- 본 헌법은 프로젝트의 모든 산출물과 개발 관행에 우선한다.
- 헌법 개정은 다음 절차를 따른다:
  1. 개정 제안서 작성 (변경 사유, 영향 범위 명시)
  2. 팀 리뷰 및 승인
  3. 헌법 문서 갱신 및 버전 변경
  4. 종속 템플릿 및 산출물 동기화
- 버전 관리 정책:
  - **MAJOR**: 원칙의 삭제 또는 근본적 재정의 (하위 호환 불가)
  - **MINOR**: 새 원칙 추가 또는 기존 원칙의 실질적 확장
  - **PATCH**: 문구 명확화, 오타 수정, 비의미적 개선
- 모든 PR 및 코드 리뷰는 본 헌법 준수 여부를 검증해야 한다.
- 헌법 원칙과 충돌하는 구현은 반드시 Complexity Tracking 테이블에 위반 사유와 대안 거부 근거를 기록한다.

**Version**: 1.1.0 | **Ratified**: 2026-01-30 | **Last Amended**: 2026-01-30
